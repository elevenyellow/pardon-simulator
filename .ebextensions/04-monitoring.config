option_settings:
  # Enhanced health reporting
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    EnhancedHealthAuthEnabled: true
    
  # Environment properties (available to all containers)
  aws:elasticbeanstalk:application:environment:
    LOG_LEVEL: info
    
files:
  "/opt/elasticbeanstalk/tasks/bundlelogs.d/01-docker-logs.conf":
    mode: "000755"
    owner: root
    group: root
    content: |
      /var/log/docker/*.log
      /var/app/current/*.log

  "/etc/cron.d/docker-cleanup":
    mode: "000644"
    owner: root
    group: root
    content: |
      # Clean up Docker resources daily at 3 AM
      0 3 * * * root docker system prune -af --filter "until=72h" > /var/log/docker-cleanup.log 2>&1

commands:
  01_create_docker_log_dir:
    command: mkdir -p /var/log/docker
    ignoreErrors: true

